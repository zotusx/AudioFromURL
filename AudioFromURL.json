{
  "author": "",
  "category": "Audio",
  "extensionNamespace": "",
  "fullName": "Audio From URL",
  "gdevelopVersion": "",
  "helpPath": "https://zotus.ru/audiofromurl",
  "iconUrl": "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0ibWRpLW11c2ljLW5vdGUtc2l4dGVlbnRoLWRvdHRlZCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xOCAxOC41QTEuNSAxLjUgMCAxIDEgMTYuNSAxN0ExLjUgMS41IDAgMCAxIDE4IDE4LjVNMTggN1YzSDEyVjEzLjU1QTQgNCAwIDEgMCAxNCAxN1YxMUgxOFY4SDE0VjdaIiAvPjwvc3ZnPg==",
  "name": "AudioFromURL",
  "previewIconUrl": "https://asset-resources.gdevelop.io/public-resources/Icons/6e661f5a0ce955e38e9bb2fc6bb9e15f6ad92f898155c48e89249c978312f630_music-note-sixteenth-dotted.svg",
  "shortDescription": "ðŸŽµ Audio From URL is an extension for GDevelop 5 that allows you to play music and sounds directly from the internet via a link. Just specify the URL of the audio file to play it!",
  "version": "1.4.0",
  "description": [
    "ðŸ”Š AudioFromURL - play music by URL in GDevelop 5",
    "This extension adds to GDevelop 5 the ability to download and play audio files directly from the internet, without having to upload them to the project manually.",
    "",
    "ðŸŒŸ Main features:",
    "âœ… Play audio by link (MP3, OGG, WAV, etc.).",
    "âœ… Volume, looping and playback control",
    "âœ… Dynamic track change (you can change URL on the fly)",
    "âœ… Supports pause, stop and status check",
    "",
    "ðŸ›  Where can I use it?",
    "",
    "Online radio in games",
    "",
    "Dynamic music downloads (e.g. from the cloud)",
    "",
    "Play custom tracks",
    "",
    "Streaming audio projects",
    "",
    "âš™ï¸ Technical features:",
    "",
    "Works via HTML5 Audio API",
    "",
    "Supports CORS (but requires proper headers on the server)",
    "",
    "Optimized for web export",
    "",
    "ðŸ“Œ Example Usage:",
    "",
    "Add an object with AudioFromURL behavior.",
    "",
    "Set the URL (https://example.com/music.mp3).",
    "",
    "Start playback - and enjoy!",
    "",
    "Perfect for developers who want to use external audio resources without the hassle! ðŸš€"
  ],
  "tags": [
    "audio",
    "url",
    "music",
    "sound"
  ],
  "authorIds": [
    "v5KAwe6HFmRdTg9dI5163IXVjm82"
  ],
  "dependencies": [],
  "globalVariables": [
    {
      "name": "Playing",
      "type": "boolean",
      "value": false
    }
  ],
  "sceneVariables": [],
  "eventsFunctions": [
    {
      "fullName": "If the sound is playing",
      "functionType": "Condition",
      "name": "SoundPlaying",
      "sentence": "If the sound is playing",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (window._gdBackgroundMusic) {",
            "    eventsFunctionContext.returnValue = !window._gdBackgroundMusic.paused && !window._gdBackgroundMusic.ended;",
            "} else {",
            "    eventsFunctionContext.returnValue = false;",
            "}"
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "fullName": "Get Sound Duration",
      "functionType": "Action",
      "name": "GetSoundDuration",
      "sentence": "Get the duration of the sound at URL _PARAM2_ and pass it to variable _PARAM1_ (in sec.)",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": []
        },
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "const url = eventsFunctionContext.getArgument(\"URL\");",
            "const audio = new Audio(url);",
            "audio.addEventListener('loadedmetadata', () => {",
            "    runtimeScene.getVariables().get(eventsFunctionContext.getArgument(\"Variable1\"))",
            "        .setString(audio.duration ? `${Math.round(audio.duration)}` : \"ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…\");",
            "});",
            "audio.addEventListener('error', () => {",
            "    runtimeScene.getVariables().get(\"TrackError\")",
            "        .setString(\"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ„Ð°Ð¹Ð»Ð°\");",
            "});",
            "",
            "audio.load();"
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "Variable to which you want to load the sound duration (in sec.)",
          "name": "Variable1",
          "type": "string"
        },
        {
          "description": "URL (to .mp3)",
          "name": "URL",
          "type": "string"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Play the sound with this action.",
      "fullName": "Play sound from URL",
      "functionType": "Action",
      "name": "PlaySoundFromURL",
      "sentence": "Play sound at URL _PARAM1_",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "const musicUrl =  eventsFunctionContext.getArgument(\"URL\");",
            "",
            "const audio = new Audio(musicUrl);",
            "audio.volume = 0.5;",
            "audio.loop = true; ",
            "",
            "audio.play().catch(e => {",
            "    console.log(\"Playback is blocked by the browser\");",
            "});",
            "",
            "window._gdBackgroundMusic = audio;",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "URL (to .mp3)",
          "name": "URL",
          "type": "string"
        }
      ],
      "objectGroups": []
    },
    {
      "fullName": "Rewind the sound",
      "functionType": "Action",
      "name": "RewindSound",
      "sentence": "Rewind the sound by _PARAM1_ seconds ",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (window._gdBackgroundMusic) {",
            "    window._gdBackgroundMusic.currentTime = eventsFunctionContext.getArgument(\"TimeInSeconds\");",
            "}",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "In seconds (Example: 1:00 - 60)",
          "name": "TimeInSeconds",
          "type": "expression"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Stop all triggered sounds with this action.",
      "fullName": "Stop sound",
      "functionType": "Action",
      "name": "StopSound",
      "sentence": "Stop all sounds",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": []
        },
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (window._gdBackgroundMusic) {",
            "    window._gdBackgroundMusic.pause();",
            "    window._gdBackgroundMusic.currentTime = 0;",
            "}",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "fullName": "Pause/resume sound",
      "functionType": "Action",
      "name": "PauseSound",
      "sentence": "Pause/resume sound",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (window._gdBackgroundMusic) {",
            "    if (window._gdBackgroundMusic.paused) {",
            "        window._gdBackgroundMusic.play(); /* Replay */",
            "    } else {",
            "        window._gdBackgroundMusic.pause(); /* Pause */",
            "    }",
            "}"
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "fullName": "Mute sound when the tab is minimized",
      "functionType": "Action",
      "name": "TurnOffSound",
      "sentence": "Mute sound when the tab is minimized",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "window._gdAudioPauseOnHide = true;",
            "document.addEventListener('visibilitychange', () => {",
            "    if (!window._gdBackgroundMusic) return;   ",
            "    if (document.hidden && window._gdAudioPauseOnHide) {",
            "        window._gdBackgroundMusic._pausedTime = window._gdBackgroundMusic.currentTime;",
            "        window._gdBackgroundMusic.pause();",
            "    } else if (window._gdBackgroundMusic._pausedTime !== undefined) {",
            "        window._gdBackgroundMusic.currentTime = window._gdBackgroundMusic._pausedTime;",
            "        window._gdBackgroundMusic.play().catch(e => console.log(\"play blocked by your browser\"));",
            "    }",
            "});"
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "fullName": "Change the sound volume",
      "functionType": "Action",
      "name": "VolumeSound",
      "sentence": "Change the sound volume value: _PARAM1_ _PARAM2_",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "const volumeOperator = eventsFunctionContext.getArgument(\"Operator\"); // \"+\", \"-\" Ð¸Ð»Ð¸ \"=\"",
            "const volumeValue = eventsFunctionContext.getArgument(\"Value\"); // Ð§Ð¸ÑÐ»Ð¾ Ð¾Ñ‚ 0 Ð´Ð¾ 100",
            "",
            "if (window._gdBackgroundMusic) {",
            "    // ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÑƒÑŽ Ð³Ñ€Ð¾Ð¼ÐºÐ¾ÑÑ‚ÑŒ (Ð¾Ñ‚ 0 Ð´Ð¾ 1)",
            "    let currentVolume = window._gdBackgroundMusic.volume * 100; // ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð² Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ñ‹",
            "    ",
            "    // ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€",
            "    let newVolume;",
            "    switch (volumeOperator) {",
            "        case \"+\":",
            "            newVolume = currentVolume + volumeValue;",
            "            break;",
            "        case \"-\":",
            "            newVolume = currentVolume - volumeValue;",
            "            break;",
            "        case \"=\":",
            "        default:",
            "            newVolume = volumeValue;",
            "            break;",
            "    }",
            "    ",
            "    // ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½ Ð¸ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð³Ñ€Ð¾Ð¼ÐºÐ¾ÑÑ‚ÑŒ",
            "    const clampedVolume = Math.min(100, Math.max(0, newVolume)) / 100;",
            "    window._gdBackgroundMusic.volume = clampedVolume;",
            "}"
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "",
          "name": "Operator",
          "supplementaryInformation": "[\"-\",\"+\",\"=\"]",
          "type": "stringWithSelector"
        },
        {
          "description": "Set the volume (example: 1-100)",
          "name": "Value",
          "type": "expression"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Smoothly lower the volume of the sound with this action.",
      "fullName": "Smoothly fading volume change",
      "functionType": "Action",
      "name": "FadeChangeVolume",
      "sentence": "Smoothly switch the volume to _PARAM1_ with a delay of _PARAM2_ ms",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": []
        },
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "const targetVolumePercent = eventsFunctionContext.getArgument(\"TargetVolume\");",
            "const fadeDuration = eventsFunctionContext.getArgument(\"DurationMs\"); ",
            "",
            "if (window._gdBackgroundMusic) {",
            "    const targetVolume = Math.min(100, Math.max(0, targetVolumePercent)) / 100;",
            "    const initialVolume = window._gdBackgroundMusic.volume;",
            "    const startTime = Date.now();",
            "    ",
            "    const fadeInterval = setInterval(() => {",
            "        const elapsed = Date.now() - startTime;",
            "        const progress = Math.min(elapsed / fadeDuration, 1);",
            "        window._gdBackgroundMusic.volume = initialVolume + (targetVolume - initialVolume) * progress;",
            "        ",
            "        if (progress >= 1) clearInterval(fadeInterval);",
            "    }, 16); /* 60fps */",
            "}"
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "Set the volume (example: 1-100)",
          "name": "TargetVolume",
          "type": "expression"
        },
        {
          "description": "Write a delay (example: 1000 ms - 1 second)",
          "name": "DurationMs",
          "type": "expression"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Smoothly switch the sound to new URL with smoothness",
      "fullName": "Smoothly switch the sound",
      "functionType": "Action",
      "name": "SmoothSoundChange",
      "sentence": "Smoothly switch the sound to _PARAM1_ with _PARAM2_ ms smoothness",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": []
        },
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "const newMusicUrl = eventsFunctionContext.getArgument(\"NewMusicURL\");",
            "const fadeDuration = eventsFunctionContext.getArgument(\"DurationMs\") || 1000;",
            "",
            "if (window._gdBackgroundMusic) {",
            "    const oldAudio = window._gdBackgroundMusic;",
            "    const initialVolume = oldAudio.volume;",
            "    const startTime = Date.now();",
            "",
            "    const newAudio = new Audio(newMusicUrl);",
            "    newAudio.volume = 0;",
            "    newAudio.loop = true;",
            "",
            "    newAudio.play().catch(e => {",
            "        console.log(\"ÐÐ²Ñ‚Ð¾Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð¾Ð¼\");",
            "    });",
            "",
            "    const fadeInterval = setInterval(() => {",
            "        const elapsed = Date.now() - startTime;",
            "        const progress = Math.min(elapsed / fadeDuration, 1);",
            "        ",
            "",
            "        oldAudio.volume = initialVolume * (1 - progress);",
            "        newAudio.volume = progress;",
            "",
            "        if (progress >= 1) {",
            "            clearInterval(fadeInterval);",
            "            oldAudio.pause();",
            "            oldAudio.currentTime = 0;",
            "            window._gdBackgroundMusic = newAudio;",
            "        }",
            "    }, 16);",
            "} else {",
            "    const audio = new Audio(newMusicUrl);",
            "    audio.volume = 1;",
            "    audio.loop = true;",
            "    audio.play().catch(e => {",
            "        console.log(\"play blocked by your browser\");",
            "    });",
            "    window._gdBackgroundMusic = audio;",
            "}"
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "URL (to .mp3)",
          "name": "NewMusicURL",
          "type": "string"
        },
        {
          "description": "Write a delay (example: 1000 ms - 1 second)",
          "name": "DurationMs",
          "type": "expression"
        }
      ],
      "objectGroups": []
    }
  ],
  "eventsBasedBehaviors": [],
  "eventsBasedObjects": []
}